{"ast":null,"code":"import _objectSpread from\"D:/Cuvette/deploy testing/MERN/Client/shortener/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import React,{useState,useEffect}from'react';import axios from'axios';import{useNavigate}from'react-router-dom';import'./Setting.css';import Delete from'./Delete';import'react-toastify/dist/ReactToastify.css';// Import the styles for toastify\nimport{toast,ToastContainer}from'react-toastify';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const Setting=()=>{const[userData,setUserData]=useState({_id:'',name:'',email:'',phone:''});const[originalEmail,setOriginalEmail]=useState('');const[showDeleteModal,setShowDeleteModal]=useState(false);const navigate=useNavigate();useEffect(()=>{const token=localStorage.getItem('authToken');if(!token){console.log('No token found, please log in');navigate('/login');return;}axios.get('https://shortly-backend-syh2.onrender.com/api/user',{headers:{Authorization:\"Bearer \".concat(token)}}).then(response=>{if(response.data.user){setUserData(_objectSpread(_objectSpread({},response.data.user),{},{_id:response.data.user._id}));setOriginalEmail(response.data.user.email);}else{console.log('Error fetching user data');}}).catch(error=>{console.error('Error fetching user data:',error);toast.error('Failed to fetch user data.');});},[navigate]);const validateInputs=()=>{const{email,phone}=userData;const emailRegex=/^[a-zA-Z0-9._-]+@[a-zA-Z0-9.-]+\\.[a-zA-Z]{2,6}$/;const phoneRegex=/^[0-9]{10}$/;if(!emailRegex.test(email)){toast.error('Invalid email address');return false;}if(!phoneRegex.test(phone)){toast.error('Invalid phone number');return false;}return true;};const handleSaveChanges=()=>{if(!validateInputs())return;const token=localStorage.getItem('authToken');if(!token){console.log('No token found, cannot save changes');return;}axios.put(\"https://shortly-backend-syh2.onrender.com/api/user/\".concat(userData._id),userData,{headers:{Authorization:\"Bearer \".concat(token)}}).then(response=>{toast.success('User data updated successfully');if(userData.email!==originalEmail){console.log('Email changed. Logging out...');localStorage.removeItem('authToken');setTimeout(()=>{navigate('/');},2000);}}).catch(error=>{console.error('Error updating user data:',error);toast.error('Failed to update user data.');});};const handleDeleteAccount=()=>{setShowDeleteModal(true);};const confirmDeleteAccount=()=>{const token=localStorage.getItem('authToken');if(!token){console.log('No token found, cannot delete account');return;}axios.delete(\"https://shortly-backend-syh2.onrender.com/api/user/\".concat(userData._id),{headers:{Authorization:\"Bearer \".concat(token)}}).then(()=>{toast.success('Account deleted successfully');localStorage.removeItem('authToken');navigate('/');}).catch(error=>{console.error('Error deleting account:',error);toast.error('Failed to delete account.');});};return/*#__PURE__*/_jsxs(\"div\",{className:\"setting-container\",children:[/*#__PURE__*/_jsxs(\"form\",{className:\"setting-form\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"setting-field\",children:[/*#__PURE__*/_jsx(\"label\",{className:\"setting-label\",children:\"Name\"}),/*#__PURE__*/_jsx(\"input\",{className:\"setting-input\",type:\"text\",placeholder:\"Rahul Singh\",value:userData.name,onChange:e=>setUserData(_objectSpread(_objectSpread({},userData),{},{name:e.target.value}))})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"setting-field\",children:[/*#__PURE__*/_jsx(\"label\",{className:\"setting-label\",children:\"Email id\"}),/*#__PURE__*/_jsx(\"input\",{className:\"setting-input\",type:\"email\",placeholder:\"rahulsingh@gmail.com\",value:userData.email,onChange:e=>setUserData(_objectSpread(_objectSpread({},userData),{},{email:e.target.value}))})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"setting-field\",children:[/*#__PURE__*/_jsx(\"label\",{className:\"setting-label\",children:\"Mobile no.\"}),/*#__PURE__*/_jsx(\"input\",{className:\"setting-input\",type:\"text\",placeholder:\"1234567890\",value:userData.phone,onChange:e=>setUserData(_objectSpread(_objectSpread({},userData),{},{phone:e.target.value}))})]}),/*#__PURE__*/_jsx(\"button\",{type:\"button\",className:\"save-button\",onClick:handleSaveChanges,children:\"Save Changes\"})]}),/*#__PURE__*/_jsx(\"div\",{className:\"delete-button-part\",children:/*#__PURE__*/_jsx(\"button\",{type:\"button\",className:\"delete-button\",onClick:handleDeleteAccount,children:\"Delete Account\"})}),showDeleteModal&&/*#__PURE__*/_jsx(Delete,{onClose:()=>setShowDeleteModal(false),onConfirm:confirmDeleteAccount}),/*#__PURE__*/_jsx(ToastContainer,{})]});};export default Setting;","map":{"version":3,"names":["React","useState","useEffect","axios","useNavigate","Delete","toast","ToastContainer","jsx","_jsx","jsxs","_jsxs","Setting","userData","setUserData","_id","name","email","phone","originalEmail","setOriginalEmail","showDeleteModal","setShowDeleteModal","navigate","token","localStorage","getItem","console","log","get","headers","Authorization","concat","then","response","data","user","_objectSpread","catch","error","validateInputs","emailRegex","phoneRegex","test","handleSaveChanges","put","success","removeItem","setTimeout","handleDeleteAccount","confirmDeleteAccount","delete","className","children","type","placeholder","value","onChange","e","target","onClick","onClose","onConfirm"],"sources":["D:/Cuvette/deploy testing/MERN/Client/shortener/src/Components/Dashboard/Modals/Setting.js"],"sourcesContent":["import React, { useState, useEffect } from 'react';\r\nimport axios from 'axios';\r\nimport { useNavigate } from 'react-router-dom';\r\nimport './Setting.css';\r\nimport Delete from './Delete'; \r\nimport 'react-toastify/dist/ReactToastify.css'; // Import the styles for toastify\r\nimport { toast, ToastContainer } from 'react-toastify'; \r\n\r\nconst Setting = () => {\r\n  const [userData, setUserData] = useState({\r\n    _id: '',\r\n    name: '',\r\n    email: '',\r\n    phone: '',\r\n  });\r\n\r\n  const [originalEmail, setOriginalEmail] = useState('');\r\n  const [showDeleteModal, setShowDeleteModal] = useState(false);\r\n\r\n  const navigate = useNavigate(); \r\n\r\n  useEffect(() => {\r\n    const token = localStorage.getItem('authToken');\r\n    if (!token) {\r\n      console.log('No token found, please log in');\r\n      navigate('/login'); \r\n      return;\r\n    }\r\n\r\n    axios\r\n      .get('https://shortly-backend-syh2.onrender.com/api/user', {\r\n        headers: { Authorization: `Bearer ${token}` },\r\n      })\r\n      .then((response) => {\r\n        if (response.data.user) {\r\n          setUserData({ ...response.data.user, _id: response.data.user._id });\r\n          setOriginalEmail(response.data.user.email); \r\n        } else {\r\n          console.log('Error fetching user data');\r\n        }\r\n      })\r\n      .catch((error) => {\r\n        console.error('Error fetching user data:', error);\r\n        toast.error('Failed to fetch user data.');\r\n      });\r\n  }, [navigate]);\r\n\r\n  const validateInputs = () => {\r\n    const { email, phone } = userData;\r\n    const emailRegex = /^[a-zA-Z0-9._-]+@[a-zA-Z0-9.-]+\\.[a-zA-Z]{2,6}$/;\r\n    const phoneRegex = /^[0-9]{10}$/;\r\n\r\n    if (!emailRegex.test(email)) {\r\n      toast.error('Invalid email address');\r\n      return false;\r\n    }\r\n    if (!phoneRegex.test(phone)) {\r\n      toast.error('Invalid phone number');\r\n      return false;\r\n    }\r\n    return true;\r\n  };\r\n\r\n  const handleSaveChanges = () => {\r\n    if (!validateInputs()) return;\r\n\r\n    const token = localStorage.getItem('authToken');\r\n    if (!token) {\r\n      console.log('No token found, cannot save changes');\r\n      return;\r\n    }\r\n\r\n    axios\r\n      .put(`https://shortly-backend-syh2.onrender.com/api/user/${userData._id}`, userData, {\r\n        headers: { Authorization: `Bearer ${token}` },\r\n      })\r\n      .then((response) => {\r\n        toast.success('User data updated successfully');\r\n        \r\n        if (userData.email !== originalEmail) {\r\n          console.log('Email changed. Logging out...');\r\n          localStorage.removeItem('authToken');\r\n          setTimeout(() => {\r\n            navigate('/'); \r\n          }, 2000);\r\n        }\r\n      })\r\n      .catch((error) => {\r\n        console.error('Error updating user data:', error);\r\n        toast.error('Failed to update user data.');\r\n      });\r\n  };\r\n\r\n  const handleDeleteAccount = () => {\r\n    setShowDeleteModal(true); \r\n  };\r\n\r\n  const confirmDeleteAccount = () => {\r\n    const token = localStorage.getItem('authToken');\r\n    \r\n    if (!token) {\r\n      console.log('No token found, cannot delete account');\r\n      return;\r\n    }\r\n    \r\n    axios\r\n      .delete(`https://shortly-backend-syh2.onrender.com/api/user/${userData._id}`, {\r\n        headers: { Authorization: `Bearer ${token}` },\r\n      })\r\n      .then(() => {\r\n        toast.success('Account deleted successfully');\r\n        localStorage.removeItem('authToken'); \r\n        navigate('/'); \r\n      })\r\n      .catch((error) => {\r\n        console.error('Error deleting account:', error);\r\n        toast.error('Failed to delete account.');\r\n      });\r\n  };\r\n\r\n  return (\r\n    <div className=\"setting-container\">\r\n      <form className=\"setting-form\">\r\n        <div className=\"setting-field\">\r\n          <label className=\"setting-label\">Name</label>\r\n          <input\r\n            className=\"setting-input\"\r\n            type=\"text\"\r\n            placeholder=\"Rahul Singh\"\r\n            value={userData.name}\r\n            onChange={(e) => setUserData({ ...userData, name: e.target.value })}\r\n          />\r\n        </div>\r\n        <div className=\"setting-field\">\r\n          <label className=\"setting-label\">Email id</label>\r\n          <input\r\n            className=\"setting-input\"\r\n            type=\"email\"\r\n            placeholder=\"rahulsingh@gmail.com\"\r\n            value={userData.email}\r\n            onChange={(e) => setUserData({ ...userData, email: e.target.value })}\r\n          />\r\n        </div>\r\n        <div className=\"setting-field\">\r\n          <label className=\"setting-label\">Mobile no.</label>\r\n          <input\r\n            className=\"setting-input\"\r\n            type=\"text\"\r\n            placeholder=\"1234567890\"\r\n            value={userData.phone}\r\n            onChange={(e) => setUserData({ ...userData, phone: e.target.value })}\r\n          />\r\n        </div>\r\n        <button type=\"button\" className=\"save-button\" onClick={handleSaveChanges}>\r\n          Save Changes\r\n        </button>\r\n      </form>\r\n\r\n      <div className=\"delete-button-part\">\r\n        <button type=\"button\" className=\"delete-button\" onClick={handleDeleteAccount}>\r\n          Delete Account\r\n        </button>\r\n      </div>\r\n\r\n      {showDeleteModal && (\r\n        <Delete\r\n          onClose={() => setShowDeleteModal(false)}\r\n          onConfirm={confirmDeleteAccount}\r\n        />\r\n      )}\r\n\r\n      {/* Toast Notifications */}\r\n      <ToastContainer />\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default Setting;\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}